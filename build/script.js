(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
module.exports={
	"initial_list": ["Java", "C","Python","C++","C#","Visual Basic .NET","JavaScript","PHP","Objective-C","SQL","Ruby","MATLAB","Groovy","Delphi/Object Pascal","Assembly language","Visual Basic",
	"Go","Swift","Perl","R"],
	"full_list": ["A# .NET","A# (Axiom)","A-0 System","A+","A++","ABAP","ABC","ABC ALGOL","ABLE","ABSET","ABSYS","ACC","Accent","Ace DASL","ACL2","ACT-III","Action!","ActionScript","Ada","Adenine","Agda","Agilent VEE","Agora","AIMMS","Alef","ALF","ALGOL 58","ALGOL 60","ALGOL 68","ALGOL W","Alice","Alma-0","AmbientTalk","Amiga E","AMOS","AMPL","APL","App Inventor for Android's visual block language","AppleScript","Arc","ARexx","Argus","AspectJ","Assembly language","ATS","Ateji PX","AutoHotkey","Autocoder","AutoIt","AutoLISP / Visual LISP","Averest","AWK","Axum","B","Babbage","Bash","BASIC","bc","BCPL","BeanShell","Batch (Windows/Dos)","Bertrand","BETA","Bigwig","Bistro","BitC","BLISS","Blue","Bon","Boo","Boomerang","Bourne shell","bash","ksh","BREW","BPEL","C","C--","C++","C#","C/AL","Caché ObjectScript","C Shell","Caml","Candle","Cayenne","CDuce","Cecil","Cel","Cesil","Ceylon","CFEngine","CFML","Cg","Ch","Chapel","CHAIN","Charity","Charm","Chef","CHILL","CHIP-8","chomski","ChucK","CICS","Cilk","CL","Claire","Clarion","Clean","Clipper","CLIST","Clojure","CLU","CMS-2","COBOL","Cobra","CODE","CoffeeScript","Cola","ColdC","ColdFusion","COMAL","Combined Programming Language","COMIT","Common Intermediate Language","Common Lisp","COMPASS","Component Pascal","Constraint Handling Rules","Converge","Cool","Coq","Coral 66","Corn","CorVision","COWSEL","CPL","csh","CSP","Csound","CUDA","Curl","Curry","Cyclone","Cython","D","DASL","DASL","Dart","DataFlex","Datalog","DATATRIEVE","dBase","dc","DCL","Deesel","Delphi","DinkC","DIBOL","Dog","Draco","DRAKON","Dylan","DYNAMO","E","E#","Ease","Easy PL/I","Easy Programming Language","EASYTRIEVE PLUS","ECMAScript","Edinburgh IMP","EGL","Eiffel","ELAN","Elixir","Elm","Emacs Lisp","Emerald","Epigram","EPL","Erlang","es","Escapade","Escher","ESPOL","Esterel","Etoys","Euclid","Euler","Euphoria","EusLisp Robot Programming Language","CMS EXEC","EXEC 2","Executable UML","F","F#","Factor","Falcon","Fancy","Fantom","FAUST","Felix","Ferite","FFP","Fjölnir","FL","Flavors","Flex","FLOW-MATIC","FOCAL","FOCUS","FOIL","FORMAC","@Formula","Forth","Fortran","Fortress","FoxBase","FoxPro","FP","FPr","Franz Lisp","Frege","F-Script","FSProg","G","Google Apps Script","Game Maker Language","GameMonkey Script","GAMS","GAP","G-code","Genie","GDL","Gibiane","GJ","GEORGE","GLSL","GNU E","GM","Go","Go!","GOAL","Gödel","Godiva","GOM (Good Old Mad)","Goo","Gosu","GOTRAN","GPSS","GraphTalk","GRASS","Groovy","Hack (programming language)","HAL/S","Hamilton C shell","Harbour","Hartmann pipelines","Haskell","Haxe","High Level Assembly","HLSL","Hop","Hope","Hugo","Hume","HyperTalk","IBM Basic assembly language","IBM HAScript","IBM Informix-4GL","IBM RPG","ICI","Icon","Id","IDL","Idris","IMP","Inform","Io","Ioke","IPL","IPTSCRAE","ISLISP","ISPF","ISWIM","J","J#","J++","JADE","Jako","JAL","Janus","JASS","Java","JavaScript","JCL","JEAN","Join Java","JOSS","Joule","JOVIAL","Joy","JScript","JScript .NET","JavaFX Script","Julia","Jython","K","Kaleidoscope","Karel","Karel++","KEE","Kixtart","KIF","Kojo","Kotlin","KRC","KRL","KUKA","KRYPTON","ksh","L","L# .NET","LabVIEW","Ladder","Lagoona","LANSA","Lasso","LaTeX","Lava","LC-3","Leda","Legoscript","LIL","LilyPond","Limbo","Limnor","LINC","Lingo","Linoleum","LIS","LISA","Lisaac","Lisp","Lite-C","Lithe","Little b","Logo","Logtalk","LPC","LSE","LSL","LiveCode","LiveScript","Lua","Lucid","Lustre","LYaPAS","Lynx","M2001","M4","Machine code","MAD","MAD/I","Magik","Magma","make","Maple","MAPPER","MARK-IV","Mary","MASM Microsoft Assembly x86","Mathematica","MATLAB","Maxima","Macsyma","Max","MaxScript","Maya (MEL)","MDL","Mercury","Mesa","Metacard","Metafont","MetaL","Microcode","MicroScript","MIIS","MillScript","MIMIC","Mirah","Miranda","MIVA Script","ML","Moby","Model 204","Modelica","Modula","Modula-2","Modula-3","Mohol","MOO","Mortran","Mouse","MPD","CIL","MSL","MUMPS","NASM","NATURAL","Napier88","Neko","Nemerle","nesC","NESL","Net.Data","NetLogo","NetRexx","NewLISP","NEWP","Newspeak","NewtonScript","NGL","Nial","Nice","Nickle","Nim","NPL","Not eXactly C","Not Quite C","NSIS","Nu","NWScript","NXT-G","o:XML","Oak","Oberon","Obix","OBJ2","Object Lisp","ObjectLOGO","Object REXX","Object Pascal","Objective-C","Objective-J","Obliq","Obol","OCaml","occam","occam-π","Octave","OmniMark","Onyx","Opa","Opal","OpenCL","OpenEdge ABL","OPL","OPS5","OptimJ","Orc","ORCA/Modula-2","Oriel","Orwell","Oxygene","Oz","P#","ParaSail (programming language)","PARI/GP","Pascal","Pawn","PCASTL","PCF","PEARL","PeopleCode","Perl","PDL","PHP","Phrogram","Pico","Picolisp","Pict","Pike","PIKT","PILOT","Pipelines","Pizza","PL-11","PL/0","PL/B","PL/C","PL/I","PL/M","PL/P","PL/SQL","PL360","PLANC","Plankalkül","Planner","PLEX","PLEXIL","Plus","POP-11","PostScript","PortablE","Powerhouse","PowerBuilder","PowerShell","PPL","Processing","Processing.js","Prograph","PROIV","Prolog","PROMAL","Promela","PROSE modeling language","PROTEL","ProvideX","Pro*C","Pure","Python","Q (equational programming language)","Q (programming language from Kx Systems)","Qalb","QtScript","QuakeC","QPL","R","R++","Racket","RAPID","Rapira","Ratfiv","Ratfor","rc","REBOL","Red","Redcode","REFAL","Reia","Revolution","rex","REXX","Rlab","RobotC","ROOP","RPG","RPL","RSL","RTL/2","Ruby","RuneScript","Rust","S","S2","S3","S-Lang","S-PLUS","SA-C","SabreTalk","SAIL","SALSA","SAM76","SAS","SASL","Sather","Sawzall","SBL","Scala","Scheme","Scilab","Scratch","Script.NET","Sed","Seed7","Self","SenseTalk","SequenceL","SETL","Shift Script","SIMPOL","SIGNAL","SiMPLE","SIMSCRIPT","Simula","Simulink","SISAL","SLIP","SMALL","Smalltalk","Small Basic","SML","Snap!","SNOBOL","SPITBOL","Snowball","SOL","Span","SPARK","Speedcode","SPIN","SP/k","SPS","Squeak","Squirrel","SR","S/SL","Stackless Python","Starlogo","Strand","Stata","Stateflow","Subtext","SuperCollider","SuperTalk","Swift (Apple programming language)","Swift (parallel scripting language)","SYMPL","SyncCharts","SystemVerilog","T","TACL","TACPOL","TADS","TAL","Tcl","Tea","TECO","TELCOMP","TeX","TEX","TIE","Timber","TMG","Tom","TOM","Topspeed","TPU","Trac","TTM","T-SQL","TTCN","Turing","TUTOR","TXL","TypeScript","Turbo C++","Ubercode","UCSD Pascal","Umple","Unicon","Uniface","UNITY","Unix shell","UnrealScript","Vala","VBA","VBScript","Verilog","VHDL","Visual Basic","Visual Basic .NET","Visual DataFlex","Visual DialogScript","Visual Fortran","Visual FoxPro","Visual J++","Visual J#","Visual Objects","Visual Prolog","VSXu","Vvvv","WATFIV, WATFOR","WebDNA","WebQL","Windows PowerShell","Winbatch","Wolfram","Wyvern","X++","X#","X10","XBL","XC","XMOS architecture","xHarbour","XL","Xojo","XOTcl","XPL","XPL0","XQuery","XSB","XSLT","XPath","Xtend","Yorick","YQL","Z notation","Zeno","ZOPL","ZPL"]
}
},{}],2:[function(require,module,exports){

const initialLanguages = require( '../_data/languages' ).initial_list;

const listenForKeyCodes = ( item, e ) => {
	if ( 32 === e.keyCode ) {
		checkForRemainingItems();
		addItemToBoard( item );
	}

	// Enter
	if ( item.classList.contains( 'is-onboard' ) ) {
		const styles = window.getComputedStyle( item );
		const itemX = styles.getPropertyValue( '--positionX' );

		let currentX = parseInt(itemX);
		
		// Move Left
		if( 37 === e.keyCode ) {
			item.style.setProperty( '--positionX',  getNewX( currentX, 'left' ) );
		}

		// Move Right
		if ( 39 === e.keyCode ) {
			item.style.setProperty( '--positionX',  getNewX( currentX, 'right' ) );
		}
	}
};

const addItemToBoard = ( item )=> {
	slider.appendChild( item );	
	item.focus();
	updateItemOnBoardState( item );
	updateItemSelectedState( item );
	Draggable.create( item, {
		type: "x",
		bounds: slider,
		dragClickables: true,
	});
};

const getNewX = ( currentX, direction ) => {
	
	let newX;
	
	if ( 'left' === direction ) {
		newX = currentX - 1;
	}
		
	if ( 'right' === direction ) {
		newX = currentX + 1;
	}
	
	if ( 0 === newX % 100  ) {
		return currentX;
	}
	
	return newX;
};

const updateItemSelectedState = ( item ) => {
	let selectedString = ' - Selected';
	let itemLabel = item.getAttribute( 'aria-label' );

	if ( document.activeElement == item ) {
		// Already selected
		// Need to update to account for on board and selected.
		if ( item.classList.contains( 'is-selected' ) ) {
			return;
		}
	
		item.classList.add( 'is-selected' );
		item.setAttribute( 'aria-label', itemLabel +  selectedString );
	} else {
		item.classList.remove( 'is-selected' );
		item.setAttribute( 'aria-label', itemLabel.replace( selectedString, '' ) );
	}

};

const updateItemOnBoardState = ( item ) => {
	const selectedString = ' - Use Left and Right arrows to move item, Tab to go to next item in list';
	let itemLabel = item.getAttribute( 'aria-label' );

	if ( document.activeElement == item ) {
		// already selected
		if ( item.classList.contains( 'is-onboard' ) ) {
			return;
		}
		
		item.classList.add( 'is-onboard' );
		item.setAttribute( 'aria-label', itemLabel +  selectedString );
	} else {
		item.classList.remove( 'is-onboard' );
		item.setAttribute( 'aria-label', itemLabel.replace( selectedString, '' ) );
	}
	
};

const checkForRemainingItems = () => {
	const remainingItems = inventory.querySelectorAll( '.js-item');

	if ( 0 < remainingItems.length ) {
		inventory.querySelectorAll( '.js-item')[0].focus();
	} else {
		// TODO: this is where we can add more langyages from JSON file.
		finalMessage.removeAttribute( 'hidden' );
	}
};

const log = c => console.log( c );

const slider = document.getElementById( 'slider' );
const inventory = document.getElementById( 'inventory' );
const finalMessage = document.getElementById( 'finalMessage' );
const form = document.getElementById( 'form' );

const createItemNode = ( name ) => {
	const button = document.createElement( 'button' );
	button.innerHTML = name;
	button.classList.add( 'js-item' );
	button.setAttribute( 'aria-label', name );
	return button;
};

window.addEventListener( 'load', () => {

	// TODO: this should be done server-side with a templating language
	initialLanguages.forEach( ( language ) => {
		let item = createItemNode( language );
		inventory.prepend( item );
	});

	const items = document.querySelectorAll( '.js-item' );
	
	// Add item event listeners
	items.forEach( (item) => {
		item.onfocus = () => {	
			updateItemSelectedState( item );
		}
		
		item.onblur = () => {
			updateItemSelectedState( item );
		}

		item.onclick = () => {
			item.focus();
			checkForRemainingItems();
			updateItemSelectedState( item );
			addItemToBoard( item );
		}
		
		item.onkeydown = ( e ) => {
			listenForKeyCodes( item, e );
		}
	});


	// Prepare object of results according to the items' position on the slider.
	document.getElementById( 'submit' ).addEventListener( 'click', ( e ) => {

		e.preventDefault();

		let languageRatingStruct = {
			name: '',
			value: ''
		};

		let entry = {
			user: {},
			data: []
		};

		const sliderBox = slider.getBoundingClientRect();
		const sliderX = sliderBox.x.toFixed();
		const sliderWidth = sliderBox.width.toFixed();

		const getItemCenter = ( item ) => {
			const box = item.getBoundingClientRect();
			const center = ( box.x + box.width / 2 );
			
			return center.toFixed();
		};
		
		const getRatingValueFromPosition = ( item ) => {
			return ( ( ( getItemCenter( item ) - sliderX ) / sliderWidth ) * 100 ).toFixed();
		};

		document.querySelectorAll( '.js-item.is-onboard' ).forEach( el => {
			let rating = Object.assign( {}, languageRatingStruct );
			rating.name = el.textContent;
			rating.value = getRatingValueFromPosition( el );

			// Add to the entry object that will be saved.
			entry.data.push( rating );
		});

		const age = document.getElementById( 'age' );

		entry.user = {
			occupation: document.getElementById( 'occupation' ).value,
			mainPL: document.getElementById( 'mainPL' ).value,
			gender: document.querySelector('input[name="gender"]:checked').value,
			age: age.options[age.selectedIndex].value
		};

		// Mark as loading
		form.classList.add( 'a-fade-to-20' );

		// Save to JSBIN
		let req = new XMLHttpRequest();

		req.onreadystatechange = () => {
			if (req.readyState == XMLHttpRequest.DONE) {
				form.classList.remove( 'a-fade-to-20' );
				form.innerHTML = '<h3 class="u-font-size-20 a-center">Your response has been recorded. Thank you!</h3>';
			}
		};

		req.open( 'POST', 'https://api.jsonbin.io/b', true);
		req.setRequestHeader( 'Content-type', 'application/json' );
		req.setRequestHeader( 'collection-id', '5d73f0ff2d1fb96463c9faa8' );
		req.setRequestHeader( 'secret-key', '$2a$10$i4oSJqC3L35lA04tt774s.VK4ZLs43L9NvsLzmblXoeHu7lUPG6ES' );
		req.send( JSON.stringify( entry ) );

	});
});

},{"../_data/languages":1}]},{},[2]);
